(function($) {
  "use strict";
  return $(function() {
		$(document).foundation();
		// Smooth sticky header animations by toggling class names on sticky parent.
		$('.site-header div[data-sticky]').on('mutateme.zf.trigger', function(e){
			var $parent = $(this.parentNode);
			if ( this.className.indexOf('is-stuck') >= 0 ) {
				$parent.addClass('child-stuck').removeClass('child-not-stuck');
			} else {
				$parent.removeClass('child-stuck').addClass('child-not-stuck');
			}
		});
		// Smooth scroll offset due to sticky nav covering page content.
		// If url is a valid hash for this page then scroll to it.
		var hash = document.location.hash;
		if ( $(hash).length > 0 ) {
			Foundation.SmoothScroll.scrollToLoc(hash, {
				offset: $('.site-header').height(),
				animationDuration: 500,
				animationEasing: 'linear',
				threshold: 50
			});
		}
		function setupScrollLinks(){
			try {
				$('#genesis-content').foundation('_destroy');
			} catch (err) {}
			var scrollOffset = new Foundation.SmoothScroll( $('#genesis-content'), {offset: $('.site-header').height()} );
		}
		setupScrollLinks();
		$(window).resize( setupScrollLinks ).one( 'scroll', function(){
			window.setTimeout( setupScrollLinks, 600 );
		});
		return;
  });
})(jQuery);
